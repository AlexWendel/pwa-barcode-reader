function e(e,t,o,i){Object.defineProperty(e,t,{get:o,set:i,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},i={},n=t.parcelRequirea202;null==n&&((n=function(e){if(e in o)return o[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return o[e]=n,t.call(n.exports,n,n.exports),n.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){i[e]=t},t.parcelRequirea202=n);var s=n.register;s("gTLMZ",function(t,o){e(t.exports,"default",function(){return s});var i=n("7kGMO"),s=class{constructor(e,t){this.url=e,this.roomId=t,this.clientId=(0,i.getDeviceUUID)(),this.websocket=null,this.onStatusChange=()=>{},this.retryCount=0,this.maxRetries=5}connect(){if(!this.url||!this.roomId)return void this.onStatusChange("error","Missing URL or Room ID.");this.websocket=new WebSocket(this.url),this.websocket.onopen=()=>{this.onStatusChange("authenticating"),this.retryCount=0;let e={type:"auth",payload:{client_id:this.clientId,client_type:"LEITOR"}};this.websocket.send(JSON.stringify(e));let t={type:"join",payload:{room_id:this.roomId}};this.websocket.send(JSON.stringify(t))},this.websocket.onmessage=e=>{let t=JSON.parse(e.data);if(console.log(t),"joined_room"===t.type)return void this.onStatusChange("connected");if("error"===t.type){this.onStatusChange("error",t.payload.message),this.disconnect();return}this.onStatusChange("joining");let o={type:"join",payload:{room_id:this.roomId}};this.websocket.send(JSON.stringify(o))},this.websocket.onclose=()=>{this.retryCount<this.maxRetries?(this.retryCount++,this.onStatusChange("reconnecting"),setTimeout(()=>{this.connect()},3e3)):this.onStatusChange("error","Failed to connect to WebSocket after 5 attempts.")},this.websocket.onerror=()=>{this.onStatusChange("error","WebSocket error")}}disconnect(){this.websocket&&this.websocket.close()}sendData(e){this.websocket&&this.websocket.readyState===WebSocket.OPEN?this.websocket.send(JSON.stringify({type:"code",payload:{data:e}})):Error("WebSocket is not open.")}}}),s("7kGMO",function(t,o){e(t.exports,"getDeviceUUID",function(){return i});function i(){let e=navigator.userAgent,t="WebDevice";return/Windows/.test(e)?t="Windows":/Mac/.test(e)?t="Mac":/Linux/.test(e)?t="Linux":/Android/.test(e)?t="Android":/iPhone|iPad|iPod/.test(e)&&(t="iOS"),/Chrome/.test(e)?t+="-Chrome":/Firefox/.test(e)?t+="-Firefox":/Safari/.test(e)&&!/Chrome/.test(e)&&(t+="-Safari"),t+="-"+Math.floor(1e3*Math.random())}}),n("gTLMZ");
//# sourceMappingURL=barcode-scanner-main.50110228.js.map
